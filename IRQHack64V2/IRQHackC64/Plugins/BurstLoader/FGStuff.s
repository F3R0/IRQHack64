JUMPTABLE	= $80

TRANSFERDATAINNER	.macro
	TYA
	PHA
	LDY #$00
	LDX #$00
-	
	LDA TRANSFERBUFFER, X
	STA \2 + (320 * (PICTUREROW+(\1)*2)),Y
	STA \2 + 1 + (320 * (PICTUREROW+(\1)*2)),Y
		
	LDA TRANSFERBUFFER+$50, X	
	STA $A0 + \2 + (320 * (PICTUREROW+(\1)*2)),Y
	STA $A0 + \2 + 1 + (320 * (PICTUREROW+(\1)*2)),Y
	
	LDA TRANSFERBUFFER+$A0, X	
	STA \2 + (320 * (PICTUREROW+(\1)*2+1)), Y
	STA \2 + 1 + (320 * (PICTUREROW+(\1)*2+1)), Y	
	
	LDA TRANSFERBUFFER+$F0, X	
	STA $A0 + \2 + (320 * (PICTUREROW+(\1)*2+1)), Y
	STA $A0 + \2 + 1 + (320 * (PICTUREROW+(\1)*2+1)), Y
	
	INX
	INY 
	INY
	CPX #80
	BNE -
	PLA
	TAY
		
	.endm

TRANSFERDATA	.macro

	TRANSFERDATAINNER \1,\2,\3
	
	LDX #00
-	
	LDA TRANSFERBUFFER+$140, X
	STA \3 + (40 * (PICTUREROW+(\1)*2)), X
	STA \3 + (40 * (PICTUREROW+(\1)*2+1)), X	
	
	LDA TRANSFERBUFFER+$168, X
	STA COLORBUFFER + (40 * \1), X
	
	INX
	CPX #40
	BNE -	

	JMP OUTCOPY	
	.endm
	
	
TRANSFERDATAEND	.macro
	TRANSFERDATAINNER \1,\2,\3
	
	LDX #00
-	
	LDA TRANSFERBUFFER + $140, X
	STA \3 + (40 * (PICTUREROW+(\1)*2)), X
	STA \3 + (40 * (PICTUREROW+(\1)*2+1)), X	
	
	INX
	CPX #40
	BNE -	
	
	JSR COPYCOLOR
	
	.CHANGEBANK \4
	
	JMP OUTCOPY	
	.endm	
	

	
	CLC
	TYA
	ASL
	TAX
	LDA JUMPTABLE,X
	STA JMPOP+1
	LDA JUMPTABLE+1, X
	STA JMPOP+2
	NOP
	NOP	
JMPOP
	JMP $F000
	
	
B0_0		
	TRANSFERDATA 0, VIDEO_B0, SCREEN_LO
B0_1
	TRANSFERDATA 1, VIDEO_B0, SCREEN_LO
B0_2
	TRANSFERDATA 2, VIDEO_B0, SCREEN_LO
B0_3
	TRANSFERDATA 3, VIDEO_B0, SCREEN_LO	
B0_4
	TRANSFERDATA 4, VIDEO_B0, SCREEN_LO
B0_5
	TRANSFERDATA 5, VIDEO_B0, SCREEN_LO
B0_6
	TRANSFERDATA 6, VIDEO_B0, SCREEN_LO
B0_7
	TRANSFERDATA 7, VIDEO_B0, SCREEN_LO
B0_8
	TRANSFERDATA 8, VIDEO_B0, SCREEN_LO
B0_9
	TRANSFERDATAEND 9, VIDEO_B0, SCREEN_LO,3
B1_0
	TRANSFERDATA 0, VIDEO_B1, SCREEN_HI
B1_1
	TRANSFERDATA 1, VIDEO_B1, SCREEN_HI
B1_2
	TRANSFERDATA 2, VIDEO_B1, SCREEN_HI
B1_3
	TRANSFERDATA 3, VIDEO_B1, SCREEN_HI
B1_4
	TRANSFERDATA 4, VIDEO_B1, SCREEN_HI
B1_5
	TRANSFERDATA 5, VIDEO_B1, SCREEN_HI
B1_6
	TRANSFERDATA 6, VIDEO_B1, SCREEN_HI
B1_7
	TRANSFERDATA 7, VIDEO_B1, SCREEN_HI
B1_8
	TRANSFERDATA 8, VIDEO_B1, SCREEN_HI
B1_9	
	TRANSFERDATAEND 9, VIDEO_B1, SCREEN_HI,2

	
	
	
	
PREPAREJMPTAB
		LDA #<B0_0
		STA JUMPTABLE
		LDA #>B0_0
		STA JUMPTABLE + 1
		
		LDA #<B0_1
		STA JUMPTABLE + 2
		LDA #>B0_1
		STA JUMPTABLE + 3

		LDA #<B0_2
		STA JUMPTABLE + 4
		LDA #>B0_2
		STA JUMPTABLE + 5
		
		LDA #<B0_3
		STA JUMPTABLE + 6
		LDA #>B0_3
		STA JUMPTABLE + 7

		LDA #<B0_4
		STA JUMPTABLE + 8
		LDA #>B0_4
		STA JUMPTABLE + 9
		
		LDA #<B0_5
		STA JUMPTABLE  + 10
		LDA #>B0_5
		STA JUMPTABLE + 11

		LDA #<B0_6
		STA JUMPTABLE + 12
		LDA #>B0_6
		STA JUMPTABLE + 13
		
		LDA #<B0_7
		STA JUMPTABLE + 14
		LDA #>B0_7
		STA JUMPTABLE + 15

		LDA #<B0_8
		STA JUMPTABLE + 16
		LDA #>B0_8
		STA JUMPTABLE + 17


		LDA #<B0_9
		STA JUMPTABLE + 18
		LDA #>B0_9
		STA JUMPTABLE + 19

		LDA #<B1_0
		STA JUMPTABLE + 20
		LDA #>B1_0
		STA JUMPTABLE + 21

		LDA #<B1_1
		STA JUMPTABLE + 22
		LDA #>B1_1
		STA JUMPTABLE + 23

		LDA #<B1_2
		STA JUMPTABLE + 24
		LDA #>B1_2
		STA JUMPTABLE + 25

		LDA #<B1_3
		STA JUMPTABLE + 26
		LDA #>B1_3
		STA JUMPTABLE + 27

		LDA #<B1_4
		STA JUMPTABLE + 28
		LDA #>B1_4
		STA JUMPTABLE + 29

		LDA #<B1_5
		STA JUMPTABLE + 30
		LDA #>B1_5
		STA JUMPTABLE + 31

		LDA #<B1_6
		STA JUMPTABLE + 32
		LDA #>B1_6
		STA JUMPTABLE + 33		
		
		LDA #<B1_7
		STA JUMPTABLE + 34
		LDA #>B1_7
		STA JUMPTABLE + 35	

		LDA #<B1_8
		STA JUMPTABLE + 36
		LDA #>B1_8
		STA JUMPTABLE + 37	
		
		LDA #<B1_9
		STA JUMPTABLE + 38
		LDA #>B1_9
		STA JUMPTABLE + 39	
		
		RTS
		
		